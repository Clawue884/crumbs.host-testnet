<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CORE+++++++ | Pi Network Heatmap Monitor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<nav>
  <a href="index.html">CORE++++</a>
  <a href="omega-console.html">Omega</a>
  <a href="cosmic-core.html">Cosmic</a>
  <a href="god-ai-core.html">God AI</a>
  <a href="quantum-sentinel.html">Sentinel</a>
  <a href="pools-radar.html">Pools</a>
</nav>

<header><h1>üöÄ CRUMBS.HOST ‚Äì CORE+++++++ HEATMAP</h1></header>

<div class="panel fade">
  <h2>üåê Network Status + AI Score</h2>
  <div id="status-box">Loading...</div>
  <div id="aiScore"></div>
</div>

<div class="panel fade">
  <h2>üìä dApps & DEX Heatmap</h2>
  <table class="heatmap">
    <thead><tr><th>dApp / Pair</th><th>Activity / Volume</th></tr></thead>
    <tbody id="heatmapBody"></tbody>
  </table>
</div>

<footer style="text-align:center; padding:10px; opacity:0.7;">CORE+++++++ ‚Ä¢ Pi Network Testnet ‚Ä¢ crumbs.host</footer>

<script>
const PI_HORIZON="https://api.testnet.minepi.com";
let lastTxCount=0;

// Notifications
if("Notification" in window) Notification.requestPermission();

// Neon popup
function showAlert(msg){
  const div=document.createElement("div");
  div.className="alert-popup";
  div.innerText=msg;
  document.body.appendChild(div);
  setTimeout(()=>div.remove(),3000);
}

// Network Status + AI
async function loadStatus(){
  try{
    const res=await fetch(`${PI_HORIZON}/ledgers?order=desc&limit=5`);
    const data=await res.json();
    const latest=data._embedded.records[0];
    document.getElementById("status-box").innerHTML=`
      <p>Ledger: ${latest.sequence}</p>
      <p>Closed At: ${latest.closed_at}</p>
      <p>Total TX: ${latest.successful_transaction_count}</p>
      <p>Status: <span style="color:#00ff6a">ONLINE</span></p>
    `;
    const avgTx=(data._embedded.records.reduce((sum,l)=>sum+l.successful_transaction_count,0)/5).toFixed(2);
    document.getElementById("aiScore").innerHTML=`<p>ü§ñ AI Score: ${avgTx}</p>`;

    if(lastTxCount && latest.successful_transaction_count>lastTxCount*1.5){
      showAlert(`‚ö° TX Spike! Ledger ${latest.sequence}: ${latest.successful_transaction_count} TX`);
      if(Notification.permission==="granted"){
        new Notification("‚ö° TX Spike Detected!",{
          body:`Ledger ${latest.sequence} has ${latest.successful_transaction_count} transactions!`,
          icon:"https://minepi.com/favicon.png"
        });
      }
    }
    lastTxCount=latest.successful_transaction_count;
  }catch{document.getElementById("status-box").innerHTML=`<p>Status: <span style="color:red">OFFLINE</span></p>`;}
}

// Heatmap dApps + DEX
const heatItems=[
  {name:"Pi Browser", type:"dApp", value:0},
  {name:"Pi NFT Hub", type:"dApp", value:0},
  {name:"Pi DeFi Swap", type:"dApp", value:0},
  {name:"PI/USDT", type:"DEX", value:0},
  {name:"PI/USDC", type:"DEX", value:0}
];
function updateHeatmap(){
  heatItems.forEach(item=>item.value=Math.floor(Math.random()*100)); // random demo
  let html="";
  heatItems.forEach(item=>{
    let cls="low";
    if(item.value>30) cls="medium";
    if(item.value>70) cls="high";
    html+=`<tr class="${cls}"><td>${item.name}</td><td>${item.value}</td></tr>`;
  });
  document.getElementById("heatmapBody").innerHTML=html;
}

// Init + auto-refresh
function init(){
  loadStatus();
  updateHeatmap();
}
init();
setInterval(init,15000);
</script>
</body>
</html>
