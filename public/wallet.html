<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PI NETWORK ‚Äî SINGULARITY MODE ‚àû</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<style>
:root{--bg:#000;--fg:#00ff9c;--panel:#020617;--warn:#ff3b3b}
.light{--bg:#f5f5f5;--fg:#063;--panel:#fff;--warn:#b00}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font-family:monospace}
#top{display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid var(--fg)}
button,input{background:transparent;color:var(--fg);border:1px solid var(--fg);padding:4px 6px}
#wall{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:1fr 1fr;gap:6px;height:calc(100vh - 42px);padding:6px}
.box{border:1px solid var(--fg);padding:6px;background:var(--panel);overflow:hidden}
h1{margin:0 0 6px 0;font-size:15px;color:#ffd700}
#tx,#ai,#stats{font-size:12px;overflow:auto;height:100%}
.badge{padding:2px 6px;border:1px solid var(--fg);margin-left:6px}
.warn{color:var(--warn)}
.glow{box-shadow:0 0 18px var(--fg) inset}
</style><style>
body {
  margin:0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: radial-gradient(circle at top, #050b1a, #02050f);
  color:#00ffd5;
}
nav {
  background:rgba(0,40,50,0.8);
  padding:10px;
  display:flex;
  gap:12px;
  justify-content:center;
  border-bottom:1px solid #00ffd5;
}
nav a {
  color:#00ffd5;
  text-decoration:none;
  padding:6px 12px;
  border-radius:6px;
  transition:0.3s;
}
nav a:hover {
  background:#00ffd5;
  color:#000;
  box-shadow:0 0 10px #00ffd5;
}
.panel {
  background:rgba(0,30,40,0.6);
  border:1px solid #00ffd5;
  border-radius:12px;
  padding:15px;
  margin:15px;
  box-shadow:0 0 15px rgba(0,255,213,0.25);
}
h1,h2 {
  text-align:center;
  text-shadow:0 0 10px #00ffd5;
}
.fade {
  animation: fadeIn 0.8s ease;
}
@keyframes fadeIn {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1; transform:translateY(0);}
}
</style>
</head>
<body>

<div id="top">
  <div>üåÄ PI NETWORK ‚Äî SINGULARITY MODE ‚àû</div>
  <div>
    <input id="wallets" placeholder="G... , G... , G..." size="38">
    <span class="badge" id="netLabel">TESTNET</span>
    <button onclick="setNet('testnet')">TESTNET</button>
    <button onclick="setNet('mainnet')">MAINNET</button>
    <button onclick="toggleTheme()">üåó</button>
  </div>
</div>

<div id="wall">
  <div class="box glow"><h1>üåç 3D EARTH + HEAT DENSITY</h1><div id="globe" style="height:100%"></div></div>
  <div class="box"><h1>üîÅ LIVE TRANSACTIONS</h1><div id="tx"></div></div>
  <div class="box"><h1>üìä NETWORK STATUS</h1><div id="stats"></div></div>
  <div class="box"><h1>üß† AI ‚Äî ANOMALY & CLUSTER</h1><div id="ai"></div></div>
</div>

<script>
let NET="testnet";
const txBox=document.getElementById("tx");
const aiBox=document.getElementById("ai");
const statsBox=document.getElementById("stats");
const netLabel=document.getElementById("netLabel");

function api(){
 return NET==="mainnet"
 ? "https://api.mainnet.minepi.com"
 : "https://api.testnet.minepi.com";
}
function setNet(n){
 NET=n;
 netLabel.textContent=n.toUpperCase();
 loadAll();
}
function toggleTheme(){document.body.classList.toggle("light");}

/* === MULTI WALLET === */
function getWallets(){
 return document.getElementById("wallets").value
   .split(",").map(w=>w.trim()).filter(w=>w.startsWith("G") && w.length===56);
}

/* === LIVE TX + AI (heuristic) === */
function loadTX(){
 fetch(api()+"/transactions?order=desc&limit=30")
 .then(r=>r.json())
 .then(d=>{
  let anomaly=false, cluster=false, bigOps=0;
  let bySource={};

  txBox.innerHTML=d._embedded.records.map(t=>{
    bySource[t.source_account]=(bySource[t.source_account]||0)+1;
    if(t.operation_count>40){ anomaly=true; bigOps++; }
    return `TX ${t.source_account.slice(0,6)}‚Ä¶ ‚Üí L${t.ledger} (${t.operation_count} ops) @ ${new Date(t.created_at).toLocaleTimeString()}<br/>`;
  }).join("");

  Object.values(bySource).forEach(v=>{ if(v>=5) cluster=true; });

  aiBox.innerHTML =
   (anomaly?`<span class="warn">‚ö†Ô∏è High-Ops Anomaly (${bigOps})</span><br/>`:"Normal ops<br/>") +
   (cluster?`<span class="warn">‚ö†Ô∏è Clustered TX Source</span>`:"No cluster");

 });
}

/* === NETWORK STATS === */
function loadStats(){
 fetch(api()+"/ledgers?order=desc&limit=1")
 .then(r=>r.json())
 .then(l=>{
  const d=l._embedded.records[0];
  statsBox.innerHTML=
   `Network: ${NET.toUpperCase()}<br/>
    Ledger: ${d.sequence}<br/>
    Ops: ${d.operation_count}<br/>
    Closed: ${new Date(d.closed_at).toLocaleTimeString()}<br/>
    Status: ONLINE ‚ö°`;
 });
}

function loadAll(){loadTX();loadStats();}
setInterval(loadAll,1800);
loadAll();

/* ==== 3D EARTH + HEAT DENSITY ==== */
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(75,1,0.1,1000);
const renderer=new THREE.WebGLRenderer({alpha:true,antialias:true});
renderer.setSize(360,360);
document.getElementById("globe").appendChild(renderer.domElement);

// Earth sphere
const earthGeo=new THREE.SphereGeometry(2,48,48);
const earthMat=new THREE.MeshBasicMaterial({wireframe:true,color:0x00ff9c});
const earth=new THREE.Mesh(earthGeo,earthMat);
scene.add(earth);

// Heat points
const heatGroup=new THREE.Group();
scene.add(heatGroup);

function addHeat(){
 const dotGeo=new THREE.SphereGeometry(0.035,8,8);
 const dotMat=new THREE.MeshBasicMaterial({color:0x00ff9c});
 const dot=new THREE.Mesh(dotGeo,dotMat);
 const u=Math.random(), v=Math.random();
 const theta=2*Math.PI*u, phi=Math.acos(2*v-1);
 const r=2.02;
 dot.position.set(
   r*Math.sin(phi)*Math.cos(theta),
   r*Math.cos(phi),
   r*Math.sin(phi)*Math.sin(theta)
 );
 heatGroup.add(dot);
 if(heatGroup.children.length>240) heatGroup.remove(heatGroup.children[0]);
}
setInterval(addHeat,80);

camera.position.z=5;
function animate(){
 requestAnimationFrame(animate);
 earth.rotation.y+=0.0025;
 heatGroup.rotation.y+=0.0025;
 renderer.render(scene,camera);
}
animate();
</script>

</body>
</html>
